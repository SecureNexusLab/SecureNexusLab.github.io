---
layout: page
title: 记一次小程序的越权攻击
author: SecureNexusLab
cover: true
sidebar: []
readmore: true
date: 2025-04-22
tags: 
- 公众号推文
- Web安全
categories:
- 公众号推文
---

发布时间: 

**总体情况**  

某小程序存在一越权漏洞

以下为系统手工验证



**来到小程序注册好然后点击个人中心，然后抓包**  
![](/images/记一次小程序的越权攻击/1752587217584.jpg)  
然后抓到数据包：![](/images/记一次小程序的越权攻击/1752587217657.jpg)  

发现被加密了，然后我们逆向破解得到key

然后解密：

![f689e7e6aa9085880aaedd1a39b7772e.jpg](/images/记一次小程序的越权攻击/1752587218056.jpg)

  

发现存在自己的ID1012504101*****466这里记录一下，然后替换成1012504101*****469然后发包![68833d0d8d5b72c4d85f53d7a3b1a667.jpg](/images/记一次小程序的越权攻击/1752587218119.jpg)

  

![](/images/记一次小程序的越权攻击/1752587218177.jpg)  
然后我们解密返回包：![f160b57cb38e038e9f85ca4a75a84905.jpg](/images/记一次小程序的越权攻击/1752587218255.jpg)

  


发现获取到了别人的信息，然后这个包含了一个bizcardId这个是企业的id然后我们记录一下：BIZCARDID25*****64

然后我们点击企业管理然后抓包

![](/images/记一次小程序的越权攻击/1752587218577.jpg)

  

![](/images/记一次小程序的越权攻击/1752587218632.jpg)  
然后我们解密一下返回包![49da6d470f99b55824157c4743421f66.jpg](/images/记一次小程序的越权攻击/1752587218886.jpg)

  

发现存在自己的敏感信息然后我们解密请求包![75b077227a4f21a832916df93a94d75f.jpg](/images/记一次小程序的越权攻击/1752587218979.jpg)

  

然后替换成为我们记录的ID BIZCARDID25*****64发包![](/images/记一次小程序的越权攻击/1752587219152.jpg)

  

然后我们解密数据包发现返回了别人的敏感信息![701e12cc40fe2ce0a82cdd7477849c81.jpg](/images/记一次小程序的越权攻击/1752587219267.jpg)

  

  

成功实现越权

1012504101******18466 自己的UID

1012504101******18469 受害者的UID

我们可以发现只有1012504101和中间的184相同只有七位数是不同的所以这是一个可遍历的ID



  

  

  

  

  

  

  

  

  

  

